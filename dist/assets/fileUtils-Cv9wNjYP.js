const s={image:{types:["image/jpeg","image/jpg","image/png","image/webp","image/gif","image/bmp","image/tiff","image/svg+xml","image/heic","image/heif","image/x-icon"],extensions:[".jpg",".jpeg",".png",".webp",".gif",".bmp",".tiff",".tif",".svg",".heic",".heif",".ico"],maxSize:20971520,icon:"üñºÔ∏è"},document:{types:["application/pdf","text/plain","text/markdown","text/csv","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/rtf","application/json","application/xml","text/xml","text/html","text/css","text/javascript","text/typescript","application/javascript","text/x-python","text/x-java","text/x-c","text/x-cpp","application/x-yaml","text/yaml"],extensions:[".pdf",".txt",".md",".csv",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".rtf",".json",".xml",".html",".htm",".css",".js",".ts",".jsx",".tsx",".py",".java",".c",".cpp",".h",".hpp",".yaml",".yml",".log",".ini",".cfg",".conf",".sh",".bat",".ps1",".sql",".go",".rs",".php",".rb",".swift",".kt",".scala",".r"],maxSize:26214400,icon:"üìÑ"},audio:{types:["audio/mpeg","audio/mp3","audio/wav","audio/ogg","audio/aac","audio/flac","audio/m4a","audio/x-ms-wma","audio/webm"],extensions:[".mp3",".wav",".ogg",".aac",".flac",".m4a",".wma",".webm"],maxSize:52428800,icon:"üéµ"},video:{types:["video/mp4","video/webm","video/ogg","video/x-msvideo","video/quicktime","video/x-ms-wmv","video/x-flv","video/x-matroska"],extensions:[".mp4",".webm",".ogv",".avi",".mov",".wmv",".flv",".mkv",".qt"],maxSize:104857600,icon:"üé¨"}},l=()=>Object.values(s).flatMap(e=>e.extensions),m=e=>{var o;const t="."+((o=e.split(".").pop())==null?void 0:o.toLowerCase());for(const[i,n]of Object.entries(s))if(n.extensions.includes(t))return i;return null},x=e=>{var i;const t="."+((i=e.split(".").pop())==null?void 0:i.toLowerCase());return{".jpg":"image/jpeg",".jpeg":"image/jpeg",".png":"image/png",".gif":"image/gif",".webp":"image/webp",".bmp":"image/bmp",".tiff":"image/tiff",".tif":"image/tiff",".svg":"image/svg+xml",".heic":"image/heic",".heif":"image/heif",".ico":"image/x-icon",".pdf":"application/pdf",".txt":"text/plain",".md":"text/markdown",".csv":"text/csv",".doc":"application/msword",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".xls":"application/vnd.ms-excel",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".ppt":"application/vnd.ms-powerpoint",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".rtf":"application/rtf",".json":"application/json",".xml":"application/xml",".html":"text/html",".htm":"text/html",".css":"text/css",".js":"text/javascript",".ts":"text/typescript",".py":"text/x-python",".java":"text/x-java",".c":"text/x-c",".cpp":"text/x-cpp",".h":"text/x-c",".hpp":"text/x-cpp",".yaml":"application/x-yaml",".yml":"application/x-yaml",".log":"text/plain",".ini":"text/plain",".cfg":"text/plain",".conf":"text/plain",".mp3":"audio/mpeg",".wav":"audio/wav",".ogg":"audio/ogg",".aac":"audio/aac",".flac":"audio/flac",".m4a":"audio/m4a",".wma":"audio/x-ms-wma",".mp4":"video/mp4",".webm":"video/webm",".ogv":"video/ogg",".avi":"video/x-msvideo",".mov":"video/quicktime",".wmv":"video/x-ms-wmv",".flv":"video/x-flv",".mkv":"video/x-matroska",".qt":"video/quicktime"}[t]||"application/octet-stream"},p=(e,t)=>{for(const[o,i]of Object.entries(s))if(i.types.includes(e))return o;return t||(e==="application/octet-stream"||e===""||!e)&&t?m(t):null},d=e=>{if(e===0)return"0 B";const t=1024,o=["B","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,i)).toFixed(1))+" "+o[i]},g=e=>p(e.type,e.name)?{valid:!0}:{valid:!1,error:`‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Á±ªÂûã„ÄÇÊîØÊåÅÁöÑÊ†ºÂºèÔºö${l().join(", ")}`},v=e=>{const t=p(e.type,e.name);if(!t)return{valid:!1,error:"Êú™Áü•ÁöÑÊñá‰ª∂Á±ªÂûã"};const o=s[t];return o?e.size>o.maxSize?{valid:!1,error:`Êñá‰ª∂ËøáÂ§ß„ÄÇÊúÄÂ§ßÊîØÊåÅ ${d(o.maxSize)}`}:{valid:!0}:{valid:!1,error:"Êú™Áü•ÁöÑÊñá‰ª∂Á±ªÂûãÈÖçÁΩÆ"}},f=e=>new Promise((t,o)=>{const i=new FileReader;i.onload=()=>{const a=i.result.split(",")[1];console.log("[FileUtils] Base64 conversion:",{fileName:e.name,originalSize:e.size,base64Length:(a==null?void 0:a.length)||0,base64Preview:(a==null?void 0:a.substring(0,50))+"...",hasValidBase64:!!a&&a.length>0}),t(a)},i.onerror=()=>o(new Error("Êñá‰ª∂ËØªÂèñÂ§±Ë¥•")),i.readAsDataURL(e)}),u=async e=>{console.log("[FileUtils] Processing file:",{name:e.name,originalMimeType:e.type,size:e.size});const t=x(e.name),o=t!=="application/octet-stream"?t:e.type;console.log("[FileUtils] MIME type resolution:",{originalMimeType:e.type,inferredFromExtension:t,finalMimeType:o});const i={...e,type:o},n=g(i);if(!n.valid)throw new Error(n.error);const a=v(i);if(!a.valid)throw new Error(a.error);const c=await f(e),r=p(o,e.name);return console.log("[FileUtils] Final attachment:",{name:e.name,type:r,mimeType:o,size:e.size,hasData:!!c}),{id:`attachment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:e.name,type:r,mimeType:o,size:e.size,data:c,url:URL.createObjectURL(e)}},h=async e=>{const t=[],o=[];for(const i of e)try{const n=await u(i);t.push(n)}catch(n){o.push(`${i.name}: ${n instanceof Error?n.message:"Â§ÑÁêÜÂ§±Ë¥•"}`)}return{attachments:t,errors:o}};export{s as FILE_CONFIG,u as createMessageAttachment,f as fileToBase64,d as formatFileSize,l as getAllSupportedExtensions,p as getFileTypeCategory,m as getFileTypeCategoryByExtension,x as getMimeTypeByExtension,h as processFiles,v as validateFileSize,g as validateFileType};
